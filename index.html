<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Manager 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        .container { background: white; padding: 1.5rem; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 400px; margin-bottom: 20px; position: relative; box-sizing: border-box; }
        h2 { text-align: center; color: #1a1a1a; margin-bottom: 1.2rem; font-size: 1.1rem; border-bottom: 2px solid #f8f9fa; padding-bottom: 10px; }
        .form-group { margin-bottom: 0.8rem; }
        input, select { width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 10px; font-size: 16px; box-sizing: border-box; background: #fafafa; }
        input:focus { border-color: #007bff; background: #fff; outline: none; }
        
        .type-selector { display: flex; gap: 10px; margin-bottom: 1.2rem; }
        .type-option { flex: 1; padding: 12px; text-align: center; border: 1px solid #e0e0e0; border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .active.income { background-color: #d4edda; color: #155724; border-color: #c3e6cb; }
        .active.expense { background-color: #f8d7da; color: #721c24; border-color: #f5c6cb; }
        
        button.submit-btn { width: 100%; padding: 14px; background-color: #007bff; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; }
        button.submit-btn:active { transform: scale(0.98); }

        /* Dashboard & Charts */
        .stat-box { background: #fff; padding: 15px; border-radius: 12px; margin-top: 10px; border: 1px solid #f0f0f0; }
        .chart-container { position: relative; height: 100px; width: 100%; }
        .stat-info { display: flex; justify-content: space-between; margin-top: 10px; font-size: 0.9rem; font-weight: bold; }
        .inc { color: #28a745; }
        .exp { color: #dc3545; }

        /* ÎšÏÏ…Ï†ÏŒ ÎœÎµÎ½Î¿Ï Balance */
        #balanceMenu { display: none; margin-top: 20px; background: #fdfdfd; padding: 15px; border-radius: 12px; border: 2px dashed #e0e0e0; }
        .balance-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.75rem; color: #333; font-weight: 500; }
        .balance-item input { width: 45%; padding: 8px; font-size: 0.9rem; border-radius: 6px; border: 1px solid #ccc; }
        .settings-icon { position: absolute; top: 15px; right: 15px; cursor: pointer; font-size: 1.3rem; opacity: 0.2; transition: 0.3s; }
        .settings-icon:hover { opacity: 1; }
    </style>
</head>
<body>

<div class="container">
    <span class="settings-icon" onclick="unlockBalance()">âš™ï¸</span>
    <h2>ğŸ’¸ ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ· ÎšÎ¯Î½Î·ÏƒÎ·Ï‚</h2>
    <form id="cashForm">
        <div class="type-selector">
            <div class="type-option active expense" id="btn-expense" onclick="setType('ÎˆÎ¾Î¿Î´Î¿')">ÎˆÎ¾Î¿Î´Î¿</div>
            <div class="type-option" id="btn-income" onclick="setType('ÎˆÏƒÎ¿Î´Î¿')">ÎˆÏƒÎ¿Î´Î¿</div>
        </div>
        <input type="hidden" id="type" value="ÎˆÎ¾Î¿Î´Î¿">
        
        <div class="form-group"><input type="date" id="date" required></div>
        <div class="form-group"><input type="number" id="amount" step="0.01" placeholder="Î Î¿ÏƒÏŒ â‚¬" required inputmode="decimal"></div>
        <div class="form-group">
            <input list="categoryList" id="category" placeholder="Î‘Î¹Ï„Î¹Î¿Î»Î¿Î³Î¯Î± / ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±" required>
            <datalist id="categoryList"></datalist>
        </div>
        <div class="form-group">
            <select id="bank" required>
                <option value="" disabled selected>Î•Ï€Î¯Î»ÎµÎ¾Îµ Î¤ÏÎ¬Ï€ÎµÎ¶Î±</option>
            </select>
        </div>
        <button type="submit" class="submit-btn" id="submitBtn">ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·</button>
    </form>

    <div id="balanceMenu">
        <h2>ğŸ¦ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Balance</h2>
        <div id="balanceInputs"></div>
        <button onclick="saveBalance()" id="balBtn" class="submit-btn" style="background-color: #28a745; margin-top:15px;">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Balance</button>
    </div>
</div>

<div class="container" id="statsContainer">
    <h2>ğŸ“Š ÎŸÎ¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ® Î•Î¹ÎºÏŒÎ½Î± 2026</h2>
    <div class="stat-box">
        <div style="font-size: 0.8rem; font-weight: bold; margin-bottom: 8px; color: #666;">Î¤Î¡Î•Î§Î©Î ÎœÎ—ÎÎ‘Î£</div>
        <div class="chart-container"><canvas id="monthChart"></canvas></div>
        <div class="stat-info">
            <span class="inc">Î•: <span id="m-inc">0â‚¬</span></span>
            <span class="exp">Î•Î¾: <span id="m-exp">0â‚¬</span></span>
        </div>
    </div>
    <div class="stat-box">
        <div style="font-size: 0.8rem; font-weight: bold; margin-bottom: 8px; color: #666;">Î£Î¥ÎÎŸÎ›ÎŸ Î•Î¤ÎŸÎ¥Î£</div>
        <div class="chart-container"><canvas id="yearChart"></canvas></div>
        <div class="stat-info">
            <span class="inc">Î•: <span id="y-inc">0â‚¬</span></span>
            <span class="exp">Î•Î¾: <span id="y-exp">0â‚¬</span></span>
        </div>
    </div>
</div>

<script>
    // Î¤ÎŸ URL Î ÎŸÎ¥ ÎœÎŸÎ¥ Î•Î”Î©Î£Î•Î£
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwe5qgI77fHRaE39ipQGyUp9KVQFVS8CxQHdwW3NB6UOtwnPluRd-z5n2Gs72f2clXR/exec";
    
    const accounts = [
        "Î‘Î¤Î¤Î™ÎšÎ—Î£ Î Î¡ÎŸÎ˜Î•Î£ÎœÎ™Î‘ÎšÎ— Î Î‘ÎÎŸÎ£", "Î‘Î¤Î¤Î™ÎšÎ—Î£ CREDIA TARGET MATURITY", "Î‘Î¤Î¤Î™ÎšÎ—Î£ Î‘ÎÎŸÎ™Î§Î¤ÎŸÎ£", 
        "Î Î•Î™Î¡Î‘Î™Î©Î£ BUSSINES", "EUROBANK Î‘ÎÎŸÎ™Î§Î¤ÎŸ Î Î‘ÎÎŸÎ£", "Î•Î Î™Î¤Î‘Î“Î•Î£", 
        "Î‘ÎÎŸÎ™Î§Î¤Î‘ Î¥Î ÎŸÎ›ÎŸÎ™Î Î‘ Î Î•Î›Î‘Î¤Î©Î", "Î‘Î¤Î¤Î™ÎšÎ—Î£ Î Î¡ÎŸÎ˜Î•Î£ÎœÎ™Î‘ÎšÎ— Î›Î™Î‘", "PRONTI", 
        "EUROBANK Î Î¡ÎŸÎ˜Î•Î£ÎœÎ™Î‘ÎšÎ— Î›Î™Î‘", "EUROBANK", "EUROBANK Î‘ÎÎŸÎ™Î§Î¤ÎŸÎ£ Î›Î™Î‘", 
        "REVOLUT", "Î Î•Î™Î¡Î‘Î™Î©Î£ BUSSINES ÎœÎ•Î¤ÎŸÎ§Î•Î£", "CASA", "VACANZE"
    ];

    let chartM, chartY;
    document.getElementById('date').valueAsDate = new Date();

    // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï„Ï‰Î½ Inputs Î³Î¹Î± Ï„Î¿ Balance
    const bDiv = document.getElementById('balanceInputs');
    accounts.forEach(acc => {
        bDiv.innerHTML += `
            <div class="balance-item">
                <span>${acc}</span>
                <input type="number" step="0.01" class="bal-val" placeholder="0.00" inputmode="decimal">
            </div>`;
    });

    function setType(v) {
        document.getElementById('type').value = v;
        document.getElementById('btn-income').className = 'type-option' + (v==='ÎˆÏƒÎ¿Î´Î¿'?' active income':'');
        document.getElementById('btn-expense').className = 'type-option' + (v==='ÎˆÎ¾Î¿Î´Î¿'?' active expense':'');
    }

    function unlockBalance() {
        const pin = prompt("Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ ÎºÏ‰Î´Î¹ÎºÏŒ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ·Ï‚:");
        if(pin === "1234") { // ÎŸ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ ÏƒÎ¿Ï…
            document.getElementById('balanceMenu').style.display = 'block';
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        } else if (pin !=="106014") {
            alert("Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!");
        }
    }

    function saveBalance() {
        const btn = document.getElementById('balBtn');
        btn.disabled = true; btn.innerText = "Î“Î¯Î½ÎµÏ„Î±Î¹ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·...";
        const vals = Array.from(document.getElementsByClassName('bal-val')).map(i => parseFloat(i.value) || 0);
        
        fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ action: "updateBalance", values: vals })
        })
        .then(r => r.json())
        .then(res => {
            btn.disabled = false; btn.innerText = "Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î¿ Balance";
            if(res.status === 'success') {
                alert("âœ… Î¤Î¿ Ï†ÏÎ»Î»Î¿ BALANCE ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!");
                document.getElementById('balanceMenu').style.display = 'none';
            }
        })
        .catch(err => alert("Î£Ï†Î¬Î»Î¼Î±: " + err));
    }

    function drawChart(id, inc, exp) {
        const ctx = document.getElementById(id).getContext('2d');
        return new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['ÎˆÏƒÎ¿Î´Î±', 'ÎˆÎ¾Î¿Î´Î±'],
                datasets: [{
                    data: [inc, exp],
                    backgroundColor: ['#28a745', '#dc3545'],
                    borderRadius: 6,
                    barThickness: 22
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { 
                    x: { beginAtZero: true, display: false }, 
                    y: { grid: { display: false }, ticks: { font: { weight: 'bold' } } } 
                }
            }
        });
    }

    function loadData() {
        fetch(SCRIPT_URL).then(r => r.json()).then(data => {
            // ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚ & Î¤ÏÎ¬Ï€ÎµÎ¶ÎµÏ‚
            document.getElementById('categoryList').innerHTML = data.categories.map(c => `<option value="${c}">`).join('');
            const bSel = document.getElementById('bank');
            const currentBank = bSel.value;
            bSel.innerHTML = '<option value="" disabled selected>Î•Ï€Î¯Î»ÎµÎ¾Îµ Î¤ÏÎ¬Ï€ÎµÎ¶Î±</option>' + 
                             data.banks.map(b => `<option value="${b}">${b}</option>`).join('');
            if(currentBank) bSel.value = currentBank;

            // ÎÎ¿ÏÎ¼ÎµÏÎ± ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÏÎ½
            document.getElementById('m-inc').innerText = data.stats.month.income.toLocaleString() + "â‚¬";
            document.getElementById('m-exp').innerText = data.stats.month.expense.toLocaleString() + "â‚¬";
            document.getElementById('y-inc').innerText = data.stats.year.income.toLocaleString() + "â‚¬";
            document.getElementById('y-exp').innerText = data.stats.year.expense.toLocaleString() + "â‚¬";

            // Î“ÏÎ±Ï†Î®Î¼Î±Ï„Î±
            if(chartM) chartM.destroy();
            if(chartY) chartY.destroy();
            chartM = drawChart('monthChart', data.stats.month.income, data.stats.month.expense);
            chartY = drawChart('yearChart', data.stats.year.income, data.stats.year.expense);
        });
    }

    window.onload = loadData;

    document.getElementById('cashForm').onsubmit = function(e) {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.disabled = true; btn.innerText = "Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·...";
        
        const payload = {
            date: document.getElementById('date').value,
            amount: document.getElementById('amount').value,
            category: document.getElementById('category').value,
            bank: document.getElementById('bank').value,
            type: document.getElementById('type').value
        };

        fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) })
        .then(r => r.json())
        .then(res => {
            btn.disabled = false; btn.innerText = "ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·";
            if(res.status === 'success') {
                document.getElementById('amount').value = '';
                document.getElementById('category').value = '';
                loadData(); // Î‘Î½Î±Î½Î­Ï‰ÏƒÎ· Î³ÏÎ±Ï†Î·Î¼Î¬Ï„Ï‰Î½
            }
        })
        .catch(err => {
            btn.disabled = false; btn.innerText = "ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·";
            alert("Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·.");
        });
    };
</script>
</body>
</html>


